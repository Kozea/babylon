{% extends "layout.html" %}

{% block head %}
<link rel="stylesheet" href="{{url_for('static', filename='ranking.css')}}">
<script>
    window.onload = on_load_ranking;
    
    function on_load_ranking(){
        var trs = document.getElementsByTagName('tr');
        for(var i = 1;i <trs.length; i++){
            console.log(trs[i].childNodes[1].firstChild.data);
            if(trs[i].childNodes[1].firstChild.data == "Green"){
                trs[i].childNodes[1].style.backgroundColor = "greenyellow";
            }
            else if(trs[i].childNodes[1].firstChild.data == "Red"){
                trs[i].childNodes[1].style.backgroundColor = "red";
            }
            else{

            }
            trs[i].childNodes[1].firstChild.data = i+"";
        }
        
    }
</script>
{% endblock %}

{% block body %} 

{% if users %}
<h1>
<a href="{{ url_for('ranking_graph')}}">Watch monthly ranking evolution !</a>
</h1>

<table>
    <thead>
        <tr>
            <th>Color</th>
            <th>Player</th>
            <th>Elo</th>
            <th>Victories</th>
            <th>Defeats</th>
            <th>Ratio</th>
        </tr>
    </thead>
    <tbody>
{% endif %}
{% for user in users %}
        <tr>
            {% if loop.index<3 %}
            <td>Green</td>
            {% elif loop.index>users|length -2 %}
            <td>Red</td>
            {% else %}
            <td>Invisible</td>
            {% endif %}
            <td>
                <img src="{{get_gravatar_url(user.photo)}}">
                
                <a href="{{ url_for('profile', id_player=user.id_user)}}">{{user.get_full_name()}}</a>
            </td>
            <td>{{user.ranking}}</td>
            {% if user.number_of_match != 0 %}
            <td>{{user.nb_victories}}</td>
            <td>{{user.nb_defeats}}</td>
            <td>{{100*(user.nb_victories/user.number_of_match)| round(2)}}
<!--
            <img src="{{ url_for('svg_victory', id_player=user.id_user)}}"></img>
-->
            </td>
            {% else %}
            <td>-</td>
            <td>-</td>
            <td>-</td>
            {% endif %}
        </tr>
{% else %}
There is no scores yet ! 
{% endfor %}
    </tbody>
</table>

{% endblock %}
